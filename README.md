<h1>Nessus Tutorial - Vulnerability Management</h1>

 ### [Video Demonstration](coming soon)
 By Josh Lindsey

<h2>Description</h2>
Project consists of the installation of Nessus Essentials - a vulnerability management scanner web application being tested on a virtual machine with potential on-board vulnerabilities. I also test this against deprecated software being installed on the virtual machine to view how the results differ on Nessus. 

<br />


<h2>Languages and Utilities Used</h2>

- <b>Command Prompt</b> 
- <b>Nessus Essentials</b>
- <b>VMware Workstation 17 PLayer</b>
- <b>Windows 10 ISO (Windows 10 Home Selected)</b>
- <b>Deprecated Firefox Program</b>


<h2>Environments Used </h2>

- <b>Windows 10 Home</b> (21H2)


<h2>Installation Steps:</h2>

- <b>Nessus Essentials: On Local PC - Go here: (https://www.tenable.com/products/nessus/nessus-essentials), download Nessus, sign up for an account using name and email, retrieve activation code to use after installation. Create username and password. Then, move to step 1.</b> 
- <b>VMware Workstation 17 Player: Go here:(https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html) download VMware Workstation 17 Player. Do this before getting started.</b>
- <b>Windows 10 ISO: Go here: (https://www.microsoft.com/en-us/software-download/windows10) and under Create Windows 10 installation media, download the tool. Select ISO once prompted and allow to download to computer. Save in easily retreivable place as vmware workstation will need to use as disk source. Do this before getting started.</b>
- <b>Deprecated Firefox Program: Be Careful where you install this. Only on isolated environments: (https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/)</b>

<h2>Program walk-through:</h2>

The first part of the lab is simply downloading and installing Nessus Essentials, VMware Workstation 17 and the Windows 10 ISO. Then configure the Virtual Machine with the proper settings. Take note of any and all user credentials you create, you will need them later (ie. Windows 10 vm username and password, nessus username and password, etc.) I did not feel the need to include this time-consuming part in the project. However, once the products are installed: 

<br />
<br />
1. Open and log into the VM. First, we want to make sure the machine is pingable. Acquire the IPv4 Address from the VM using cmd - ipconfig and attempt to ping from your local PC. If it fails, you will need to disable the firewall on the vm and re-ping. To do this, search wf.msc on the vm, go to properties and disable all protections. You can add a -t to the end of your ping (on local) for a perpetual ping attempt:  <br/>
<br />
<img src="https://i.imgur.com/0D3H9RF.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />


<p align="center">
2. Launch the utility: Nessus Essentials from the browser on your local PC. Google Chrome is preferred. Once launched, it will configure the plugins: <br/>
  <br />
<img src="https://i.imgur.com/TrecISf.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
3. Once launched and pluggins are installed, it will give you the option to scan.   <br/>
  <br />
<img src="https://i.imgur.com/XAOQQPm.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. Choose Basic Network Scan: <br/>
  <br />
<img src="https://i.imgur.com/nYWFKUm.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
5. Name the Scan and input the IPv4 Address of the VM under 'Targets'. Note that you can schedule out scans here - used more so for coorporations and organizations:  <br/>
  <br />
<img src="https://i.imgur.com/HLcpsKe.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Wait for process to complete (may take some time) then review to see that scan is complete. It will inform you how many vulnerabilities there may be:  <br/>
  <br />
<img src="https://i.imgur.com/wFutPDM.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Clicking on the link will show you a list of what is vulnerable. 'Info' simply means things you should know or could improve upon, but is not vital. <br/>
  <br />
<img src="https://i.imgur.com/vUwJwRV.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
If we click on the MEDIUM vulnerability, you can see that it goes into detail on what exactly is wrong. On this example, SMB signing isn't required on the computer which can lead to man-in-the-middle attacks through an exploit. Nessus also gives some solutions. <br/>
  <br />
<img src="https://i.imgur.com/w0xiI9M.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

  <h2>Credentialed Scans: A Deeper Dive Into System Vulnerabilities</h2>

- <b>The documentation for instructions on how to do this was provided by Nessus directly. Going forward, we will modify system settings on the VM to be more vulnerable and open for our credentialed scan. This will allow a demonstration of what a typical vulnerability scan will look like beyond the MEDIUM scope. Keep in mind that this is done in an isolated environment and I would NOT recommend doing this on a personal computer. </b> (21H2)

<br />
<br />
Go back to VM and head to Services.msc to enable the remote registry. Once in services, just type 're' and it will leap down to the remote services. Find Remote Registry, double click and set to automatic, hit apply, then Start: <br/>
  <br />
<img src="https://i.imgur.com/SOq4c7F.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
File and Printer Sharing may already be on, but check just in case. If not, enable: <br/>
  <br />
<img src="https://i.imgur.com/NVff9lS.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Next, go to UAC Settings and drag down to 'Never Notify'. It's not good to do, but considering this is a throwaway environment, and a sandbox for Nessus experimentation, it's fine. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Head over to reg edit and navigate to LocalMachine > Software > Microsoft > Windows > CurrentVersion > Policies > System and create a D-Word named 'LocalAccountTokenFilterPolicy'. CASE sensitive. Set Value to 1. Restart VM.<br/>
  <br />
<img src="https://i.imgur.com/cpxcqgz.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

Head back to Nessus. Navigate back to the MyScans tab and check the scan on the left hand side. From there, click More at the top and choose Configure.  <br/>
  <br />
<img src="https://i.imgur.com/ntec8Cn.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Navigate to the credentials tab. Hopefully, you took note of the windows login credentials - but incase you did not, go to the VM and type 'whoami' in the command prompt (cmd) and take note of the name. Use this name under username in Nessus. Enter the password as well. Leave 'Domain' blank. Leave Global Credential Settings at default. Hit Save. Head back to MyScans and run. <br/>
  <br />
<img src="https://i.imgur.com/M3LbIxW.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Once complete, take note of how many more vulnerabilities there are through the credentialed scan. 'Mixed' is a mix of HIGH and MEDIUM score vulnerabilties. In this lab, I'm going to remediate these vulnerabilities. Please note, if there is no change, check Services to ensure Remote Registry is running and double check regedit to ensure the LocalAccountTokenFilterPolicy D-Word is actually in the directory and set to 1. Failure to adhere to these steps may result in no change in the management scanner. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Next, go to UAC Settings and drag down to 'Never Notify'. It's not good to do, but considering this is a throwaway environment, and a sandbox for Nessus experimentation, it's fine. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Next, go to UAC Settings and drag down to 'Never Notify'. It's not good to do, but considering this is a throwaway environment, and a sandbox for Nessus experimentation, it's fine. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Next, go to UAC Settings and drag down to 'Never Notify'. It's not good to do, but considering this is a throwaway environment, and a sandbox for Nessus experimentation, it's fine. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Next, go to UAC Settings and drag down to 'Never Notify'. It's not good to do, but considering this is a throwaway environment, and a sandbox for Nessus experimentation, it's fine. <br/>
  <br />
<img src="https://i.imgur.com/vXrH1P5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
